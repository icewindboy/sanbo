<html>
<title name="存货库存量">
<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="25">
<iframe id="prod" src="" width="95%" height=25 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no style="display:none"></iframe>
<page type="templet" height="29.7" width="21" magin-left="1" magin-right="1" magin-top="0.6" magin-bottom="1" footer-center="第 &P 页，共 &N 页" font-size="9">
<dataset name="a" object="" type="sql">
  <field name="cpbm" caption="产品编码" group="true" include="cpid" datatype="varchar">
  <field name="pm" caption="品名" group="true" datatype="varchar">
  <field name="gg" caption="规格" group="true" datatype="varchar">
  <field name="sxz" caption="规格属性" group="true" datatype="varchar">
  <field name="jldw" caption="单位" group="true" datatype="varchar">
  <field name="kcsl" caption="帐存数量" sum="true" datatype="number">
  <field name="hsdw" caption="换算单位" group="true" datatype="varchar">
  <field name="kchssl" caption="帐存换算数量" sum="true" datatype="number">
  <field name="wjzssl" caption="未记帐收数量" sum="true" datatype="number">
  <field name="wjzfsl" caption="未记帐发数量" sum="true" datatype="number">
  <field name="hjsl" caption="合计" sum="true" datatype="number">
  <field name="hjhssl" caption="换算数量合计" sum="true" datatype="number">
  <where field="ksrq" caption="日期" linktable="" need="true" linkcolumn="" querycolumn="" opersign="&gt;=" initvalue="{yyyy}-{mm}-01" datatype="date">
  <where field="jsrq" caption="--" linktable=""need="true" linkcolumn="" querycolumn="" opersign="&lt;=" initvalue="{date}" datatype="date">
  <where field="cpid" caption="品名规格" datatype="number" opersign="=" type="lookup" span="true" codeonchange="productCodeSelect(this,'@')" nameonchange="productNameSelect(this,'@')" onclick="ProdSingleSelect('fixedQueryform','@','fieldVar=cpid&fieldVar=cpbm&fieldVar=product')">
  <where field="storeid" caption="仓库" datatype="number" opersign="=" type="select"  lookup="kc_ck" >
  <where field="chlbid" caption="存货类别" datatype="number" opersign="=" type="select"  lookup="kc_chlb" >
  <where field="startcpbm" caption="产品编码" linktable="" linkcolumn="" querycolumn="" opersign="&gt;=" initvalue="" datatype="varchar">
  <where field="endcpbm" caption="--" linktable="" linkcolumn="" querycolumn="" opersign="&lt;=" initvalue="" datatype="varchar">
  <where field="pm" caption="品名" datatype="varchar">
  <where field="gg" caption="规格" datatype="varchar">
  <param name="fgsid" datatype="number" value="{fgsid}">
</dataset>
<table width="100%" border="0" cellspacing="0" cellpadding="1" type="static">
  <tr>
     <td align="center" valign="middle" style="font-size:16" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12" font-bold="1">存货库存量</td>
  </tr>
  <tr>
	 <td align="center" valign="middle" border-left="0" border-right="0" border-top="0" border-bottom="0">{where.a$ksrq} -- {where.a$jsrq}</td>
  </tr>
</table>
<table id="tableview1" dataset="a" width="100%" border="0" cellspacing="0" cellpadding="2" class="table" type="dynamic" fillnull="false" header="1">
  <tr>
    <td align="center" valign="middle" nowrap="true" width="45" field="*"></td>
    <td align="center" valign="middle" nowrap="true" field="cpbm">产品编码</td>
    <td align="center" valign="middle" nowrap="true" field="pm">品名</td>
    <td align="center" valign="middle" nowrap="true" field="gg">规格</td>
	<td align="center" valign="middle" nowrap="true" field="sxz">规格属性</td>
    <td align="center" valign="middle" nowrap="true" field="jldw">单位</td>
    <td align="center" valign="middle" nowrap="true" field="kcsl">帐存数量</td>
    <td align="center" valign="middle" nowrap="true" field="hsdw">换算单位</td>
    <td align="center" valign="middle" nowrap="true" field="kchssl">帐存换算数量</td>
    <td align="center" valign="middle" nowrap="true" field="wjzssl">未记帐收数量</td>
    <td align="center" valign="middle" nowrap="true" field="wjzfsl">未记帐发数量</td>
    <td align="center" valign="middle" nowrap="true" field="hjsl">合计</td>
    <td align="center" valign="middle" nowrap="true" field="hjhssl">换算数量合计</td>
  </tr>
  <tr onclick="selectRow();">
    <td nowrap="true"><value field="*">
    <input name="image" class="img" type="image" title="货物明细" onClick="selectRow();proddetailRep('{cpid}','{dmsxid}','{fgsid}','{where.a$ksrq}','{where.a$jsrq}', '{where.a$storeid}')" src='../images/select_prod.gif' border="0">
    <input name="image" class="img" type="image" title="存货收发单据明细" value="{cpbm}" onClick="selectRow();detailRep('{cpid}','{dmsxid}','{fgsid}', '{where.a$ksrq}','{where.a$jsrq}', '{where.a$storeid}')" src="../images/edit.gif" border="0"></td>
    <td nowrap="true"><value field="cpbm"></td>
    <td nowrap="true"><value field="pm"></td>
    <td nowrap="true"><value field="gg"></td>
    <td nowrap="true"><value field="sxz"></td>
    <td nowrap="true"><value field="jldw"></td>
    <td nowrap="true" align="right"><value field="kcsl" format="{qtyformat}"></td>
    <td nowrap="true" align="center"><value field="hsdw"></td>
    <td nowrap="true" align="right"><value field="kchssl" format="{qtyformat}"></td>
    <td nowrap="true" align="right"><value field="wjzssl" format="{qtyformat}"></td>
    <td nowrap="true" align="right"><value field="wjzfsl" format="{qtyformat}"></td>
    <td nowrap="true" align="right"><value field="hjsl" format="{qtyformat}"></td>
    <td nowrap="true" align="right"><value field="hjhssl" format="{qtyformat}"></td>
  </tr>
  <widths value="9,13,9,3,10,10,3,10,10,10,10,10">
</table>
<SCRIPT LANGUAGE="javascript">initDefaultTableRow('tableview1',1);
  function productCodeSelect(obj,srcVars)
  {
    ProdCodeChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
  }
  function productNameSelect(obj,srcVars)
  {
    ProdNameChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
  }
  function detailRep(cpid,dmsxid, fgsid, ksrq, jsrq, storeid){
    if(cpid=="")
      return;
    openSelectUrl('showdetail.jsp?operate=showdetail&code=kc_stocks_detail&a$cpid='+cpid+'&a$dmsxid='+dmsxid+'&a$fgsid='+fgsid+'&a$rq$a='+ksrq+'&a$rq$b='+jsrq+'&a$storeid='+storeid+'&a$zt=1', 'kc_stocks_detail');
  }
  function proddetailRep(cpid,dmsxid, fgsid, ksrq, jsrq, storeid){
    if(cpid=="")
      return;
    openSelectUrl('showdetail.jsp?operate=showdetail&code=kc_stocks_prod_detail0&a$cpid='+cpid+'&a$dmsxid='+dmsxid+'&a$fgsid='+fgsid+'&a$sfrq$a='+ksrq+'&a$sfrq$b='+jsrq+'&a$storeid='+storeid, 'kc_stocks_prod_detail0');
  }
</SCRIPT>
</body>
</html>