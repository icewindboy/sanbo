<html>
<title name="应收帐款分类汇总表">
<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="25">
<iframe id="prod" src="" width="95%" height=25 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no style="display:none"></iframe>
<page type="templet" height="24" width="27.4" magin-left="0.6" magin-right="0.6" magin-top="0.8" magin-bottom="1" footer-center="第 &P 页，共 &N 页" font-size="10">
<dataset name="a" object="PCK_SALE_REP.xs_receivable_collect(?,'@','@','@','@','@','@')" type="procedure">
  <field name="dwdm" caption="单位代码" group="true"  datatype="number">
   <field name="dwmc" caption="单位" group="true"  datatype="varchar">

  <field name="aye" caption="上月尚欠" sum="true"  datatype="number">
  <field name="axsje" caption="本月销售" sum="true"  datatype="number">
  <field name="assje" caption="本月收回" sum="true"  datatype="number">
  <field name="aqian" caption="本月结欠" sum="true"  datatype="number">

  <field name="cye" caption="上月尚欠" sum="true"  datatype="number">
  <field name="cxsje" caption="本月销售" sum="true"  datatype="number">
  <field name="cssje" caption="本月收回" sum="true"  datatype="number">
  <field name="cqian" caption="本月结欠" sum="true"  datatype="number">

  <field name="acye" caption="上月尚欠" sum="true"  datatype="number">
  <field name="acxsje" caption="本月销售" sum="true"  datatype="number">
  <field name="acssje" caption="本月收回" sum="true"  datatype="number">
  <field name="acqian" caption="本月结欠" sum="true"  datatype="number">

  <where field="rq" caption="日期" linktable="" need="true" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="{yyyy}-{mm}-01" datatype="date">
  <where field="rq" caption="--" linktable=""need="true" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="{date}" datatype="date">
  <where field="djxz" caption="数据来源"  opersign="=" value="1=提单" type="radio" initvalue="1" span="true">
  <where field="dwtxid" caption="客户名称" datatype="number" opersign="=" type="lookup" span="true"
  codeonchange="corpCodeSelect(this,'@')" nameonchange="corpNameSelect(this,'@')"onclick="CustSingleSelect('fixedQueryform','@','fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc')">

  <where field="personid" caption="业务员" need="false" datatype="number" opersign="=" type="select"  lookup="emp" span="true">
  
  <param name="fgsid" datatype="number" value="{fgsid}">
</dataset>
<table width="100%" border="0" cellspacing="0" cellpadding="1" type="static">
  <tr>
    <td align="center"  style="font-size:16"   border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12" font-bold="1">应收帐款分类汇总表</td>
  </tr>
  <tr>
    <td align="center"  style="font-size:12" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12">{where.a$rq$a} -- {where.a$rq$b}</td>
  </tr>
</table>
<table id="tableview1"   class="table" dataset="a"  width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" fillnull="false" header="2">

  <tr> 
   <td  rowspan="2" align="center"  nowrap="true" field="dwdm">单位代码</td>
    <td rowspan="2" align="center"  nowrap="true" field="dwmc">单位</td>
	<td colspan="4" align="center"  nowrap="true" field="aye,axsje,assje,aqian">A类</td>
    <td colspan="4" align="center"  nowrap="true" field="cye,cxsje,cssje,cqian">C类</td>
	<td colspan="4" align="center"  nowrap="true" field="acye,acxsje,acssje,acqian">AC类</td>
  </tr>
  <tr>
    <td align="center"  nowrap="true" field="aye">上月尚欠</td>
	<td align="center"  nowrap="true" field="axsje">本月销售</td>
	<td align="center"  nowrap="true" field="assje">本月收回</td>
	<td align="center"  nowrap="true" field="aqian">本月结欠</td>

    <td align="center"  nowrap="true" field="cye">上月尚欠</td>
	<td align="center"  nowrap="true" field="cxsje">本月销售</td>
	<td align="center"  nowrap="true" field="cssje">本月收回</td>
	<td align="center"  nowrap="true" field="cqian">本月结欠</td>

    <td align="center"  nowrap="true" field="acye">上月尚欠</td>
	<td align="center"  nowrap="true" field="acxsje">本月销售</td>
	<td align="center"  nowrap="true" field="acssje">本月收回</td>
	<td align="center"  nowrap="true" field="acqian">本月结欠</td>
  </tr>
  <tr  onClick="selectRow();"   onDblClick="selectRow();detailRep('{dwtxid}')">
  <td nowrap="true"><value field="dwdm"></td>
	<td nowrap="true"><value field="dwmc"></td>

	<td nowrap="true" align="right"><value field="aye" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="axsje" format="#,##0.00" zeroformat=""></td>
    <td nowrap="true" align="right"><value field="assje" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="aqian" format="#,##0.00" zeroformat=""></td>

	<td nowrap="true" align="right"><value field="cye" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="cxsje" format="#,##0.00" zeroformat=""></td>
    <td nowrap="true" align="right"><value field="cssje" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="cqian" format="#,##0.00" zeroformat=""></td>

	<td nowrap="true" align="right"><value field="acye" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="acxsje" format="#,##0.00" zeroformat=""></td>
    <td nowrap="true" align="right"><value field="acssje" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="acqian" format="#,##0.00" zeroformat=""></td>
  </tr>
  <widths value="6,20,11,11,11,11,11,11,11,11,11,11,11,11,11"> 
</table>
<SCRIPT LANGUAGE='javascript' id='where'>var i=0;</SCRIPT>
<SCRIPT LANGUAGE="javascript">initDefaultTableRow('tableview1',2);</SCRIPT>
<SCRIPT LANGUAGE="javascript">
 function corpCodeSelect(obj,srcVar)
{
  CustCodeChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc', obj.value);
}
function corpNameSelect(obj,srcVar)
{
  CustNameChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc', obj.value);
}
function detailRep(param){
if(param=='')
return;
if(param==null)
return;openSelectUrl('showdetail.jsp?operate=showdetail&code=xs_receivable_detail&a$rq$a='+ksrq+'&a$rq$b='+jsrq+'&a$djxz='+djxz+'&a$dwtxid='+param, 'xs_receivable_detail');
}
</SCRIPT>
</body>
</html>