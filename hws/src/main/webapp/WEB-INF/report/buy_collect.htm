<html>
<title name="采购汇总报表">
<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="25">
<page type="templet" height="21" width="29.7" magin-left="1" magin-right="1" magin-top="0.8" magin-bottom="1" footer-center="第 &P 页，共 &N 页" font-size="9">
<dataset name="a" object="REP_BUY_JHD_COLLECT" type="sql">
  <where field="jhrq" caption="日期" linktable="" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="{yyyy}-{mm}-01" datatype="date">
  <where field="jhrq" caption="--" linktable="" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="{date}" datatype="date">
  <where field="khlx" caption="客户类型" opersign="=" value="=全部&A=A&C=C" type="radio">
  <where field="type" caption="数据来源" opersign="=" value="=进货单&1=发票" type="radio" span="true">
  <where field="hzff" caption="汇总方法" opersign="=" value="=按存货汇总&1=按供应商汇总" type="radio" span="true">
  <where field="zt" caption="包括未记帐" opersign="=" value="=包括&1=不包括" type="radio" span="true" >
  <param name="fgsid" datatype="number" value="{fgsid}">
</dataset>
<table width="100%" border="0" cellspacing="0" cellpadding="1" type="static">
  <tr>
     
    <td align="center" valign="middle" style="font-size:16" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12" font-bold="1">采购汇总报表</td>
  </tr>
   <tr>
	 <td align="center" valign="middle" border-left="0" border-right="0" border-top="0" border-bottom="0">{where.a$jhrq$a} -- {where.a$jhrq$b}</td>
  </tr>
</table>
<table id="tableview1" class="table" dataset="a" name="jhdchhz" width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" fillnull="true" header="1">
  <tr > 
	<td align="center" valign="middle" nowrap="true" field="cpbm">代码</td>
    <td align="center" valign="middle" nowrap="true" field="pm">品名</td>
    <td align="center" valign="middle" nowrap="true" field="gg">规格</td>
	<td align="center" valign="middle" nowrap="true" field="sxz">规格属性</td>
    <td align="center" valign="middle" nowrap="true" field="jldw">计量单位</td>
	<td align="center" valign="middle" nowrap="true" field="sl">数量</td>
    <td align="center" valign="middle" nowrap="true" field="dj">平均单价</td>
    <td align="center" valign="middle" nowrap="true" field="je">金额</td>
  </tr>
  <tr onClick="selectRow();" onDblClick="selectRow();detailRep('{cpbm}','{fgsid}','{dmsxid}')"> 
	<td nowrap="true"><value field="cpbm"></td>
    <td nowrap="true"><value field="pm"></td>
    <td nowrap="true"><value field="gg"></td>
	<td nowrap="true"><value field="sxz"></td>
    <td nowrap="true"><value field="jldw"></td>
	<td nowrap="true" align="right"><value field="sl" format="{qtyformat}"></td>
    <td nowrap="true" align="right"><value field="dj" format="{priceformat}"></td>
    <td nowrap="true" align="right"><value field="je" format="{sumformat}"></td>
  </tr>
  <widths value="11,16,9,15,8,10,11,11"> 
</table>
<table id="tableview2" class="table" dataset="a" name="jhdgyshz" width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" fillnull="true" header="1">
  <tr> 
<td align="center" valign="middle" nowrap="true" field="dwdm">单位代码</td>
    <td align="center" valign="middle" nowrap="true" field="dwmc">供应商名称</td>
	<td align="center" valign="middle" nowrap="true" field="sl">数量</td>
    <td align="center" valign="middle" nowrap="true" field="je">金额</td>
  </tr>
  <tr onClick="selectRow();" onDblClick="selectRow();corpdetailRep('{dwtxid}','{fgsid}')> 
<td nowrap="true"><value field="dwdm"></td>
    <td nowrap="true"><value field="dwmc"></td>
	<td nowrap="true" align="right"><value field="sl" format="{qtyformat}"></td>
    <td nowrap="true" align="right"><value field="je" format="{sumformat}"></td>
  </tr>
  <widths value="11,18,11,11"> 
</table>
<table id="tableview3" class="table" dataset="a" name="fpchhz" width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" fillnull="true" header="1">
  <tr > 
	<td align="center" valign="middle" nowrap="true" field="cpbm">产品代码</td>
    <td align="center" valign="middle" nowrap="true" field="pm">品名</td>
    <td align="center" valign="middle" nowrap="true" field="gg">规格</td>
	<td align="center" valign="middle" nowrap="true" field="sxz">规格属性</td>
    <td align="center" valign="middle" nowrap="true" field="jldw">计量单位</td>
	<td align="center" valign="middle" nowrap="true" field="sl">数量</td>
    <td align="center" valign="middle" nowrap="true" field="je">金额</td>
    <td align="center" valign="middle" nowrap="true" field="se">税额</td>
	<td align="center" valign="middle" nowrap="true" field="jshj">价税合计</td>
  </tr>
  <tr onClick="selectRow();" onDblClick="selectRow();financeRep('{cpbm}','{fgsid}','{dmsxid}')"> 
	<td nowrap="true"><value field="cpbm"></td>
    <td nowrap="true"><value field="pm"></td>
    <td nowrap="true"><value field="gg"></td>
	<td nowrap="true"><value field="sxz"></td>
    <td nowrap="true"><value field="jldw"></td>
    <td nowrap="true" align="right"><value field="sl" format="{qtyformat}"></td>
	<td nowrap="true" align="right"><value field="je" format="{sumformat}"></td>
    <td nowrap="true" align="right"><value field="se" format="{sumformat}"></td>
    <td nowrap="true" align="right"><value field="jshj" format="{sumformat}"></td>
  </tr>
  <widths value="10,16,10,16,9,10,10,11,11"> 
</table>
<table id="tableview4" class="table" dataset="a" name="fpgyshz" width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" fillnull="true" header="1">
  <tr> 
<td align="center" valign="middle" nowrap="true" field="dwdm">单位代码</td>
	<td align="center" valign="middle" nowrap="true" field="dwmc">供应商名称</td>
	<td align="center" valign="middle" nowrap="true" field="sl">数量</td>
    <td align="center" valign="middle" nowrap="true" field="je">金额</td>
    <td align="center" valign="middle" nowrap="true" field="se">税额</td>
	<td align="center" valign="middle" nowrap="true" field="jshj">价税合计</td>
  </tr>
  <tr onClick="selectRow();" onDblClick="selectRow();corpfinanceRep('{dwtxid}','{fgsid}')"> 
	<td nowrap="true"><value field="dwdm"></td>
	<td nowrap="true"><value field="dwmc"></td>
    <td nowrap="true" align="right"><value field="sl" format="{qtyformat}"></td>
	<td nowrap="true" align="right"><value field="je" format="{sumformat}"></td>
    <td nowrap="true" align="right"><value field="se" format="{sumformat}"></td>
    <td nowrap="true" align="right"><value field="jshj" format="{sumformat}"></td>
  </tr>
  <widths value="11,15,11,11,11,11"> 
</table>
<SCRIPT LANGUAGE='javascript' id='where'>var i=0;</SCRIPT>
<SCRIPT LANGUAGE="javascript">
var isShow = false;
for(i=1; i<=4; i++)
{
  table = document.all['tableview'+i];
  if(table+'' != 'undefined')
  {
	if(isShow)
	  table.style.display ="none";  
	else
	{
	  isShow = true;
	  initDefaultTableRow('tableview'+i,1);
	}
  }
}
function detailRep(param,fgsid,dmsxid){
if(param=="")
return;
	openSelectUrl	('showdetail.jsp?operate=showdetail&code=buy_jhd_detail&a$cpbm='+param+'&a$fgsid='+fgsid+'&a$khlx='+khlx+'&a$jhrq$a='+ksrq+'&a$jhrq$b='+jsrq+'&a$zt='+zt+'&a$dmsxid='+dmsxid, 'buy_jhd_detail');
}
function financeRep(param,fgsid,dmsxid){
if(param=="")
return;
	openSelectUrl	('showdetail.jsp?operate=showdetail&code=buy_fp_detail&a$cpbm='+param+'&a$fgsid='+fgsid+'&a$kprq$a='+ksrq+'&a$kprq$b='+jsrq+'&a$zt='+zt+'&a$dmsxid='+dmsxid, 'buy_fp_detail');
}
function corpdetailRep(param,fgsid){
if(param=="")
return;
	openSelectUrl	('showdetail.jsp?operate=showdetail&code=buy_jhd_detail&a$dwtxid='+param+'&a$fgsid='+fgsid+'&a$khlx='+khlx+'&a$jhrq$a='+ksrq+'&a$jhrq$b='+jsrq+'&a$zt='+zt, 'buy_jhd_detail');
}
function corpfinanceRep(param,fgsid){
if(param=="")
return;
	openSelectUrl	('showdetail.jsp?operate=showdetail&code=buy_fp_detail&a$dwtxid='+param+'&a$fgsid='+fgsid+'&a$kprq$a='+ksrq+'&a$kprq$b='+jsrq+'&a$zt='+zt, 'buy_fp_detail');
}
 function corpCodeSelect(obj,srcVar)
{
  ProvideCodeChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc', obj.value);
}
function corpNameSelect(obj,srcVar)
{
  ProvideNameChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc', obj.value);
}
</SCRIPT>
</body>
</html>