<html>
<title name="销售合同执行情况">
<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="25">
<iframe id="prod" src="" width="95%" height=25 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no style="display:none"></iframe>

<page type="templet" height="27.4" width="24" magin-left="1" magin-right="1" magin-top="0.8" magin-bottom="1" footer-center="第 &P 页，共 &N 页" font-size="12">

<dataset name="a" object="REP_XS_HT_PERFORM" type="sql">
  <field name="htlx" caption="合同类型" group="true" datatype="varchar">
  <field name="areacode" caption="地区号" group="true" datatype="number">
  <field name="dqmc" caption="地区名称" group="true" datatype="varchar">
  <field name="dwdm" caption="客户代码" group="true" datatype="number">
  <field name="dwmc" caption="客户名称" group="true" datatype="varchar">
  <field name="mc" caption="部门" group="true" datatype="varchar">
  <field name="xm" caption="业务员" group="true" datatype="varchar">
  <field name="htrq" caption="日期" group="true" datatype="date">
  <field name="htbh" caption="合同号" group="true" include="htid">
  <field name="cpbm" caption="产品编码" group="true"  datatype="varchar">
  <field name="pm" caption="品名" group="true" datatype="varchar">
  <field name="gg" caption="规格" group="true" datatype="varchar">
  <field name="sxz" caption="规格属性" group="true" datatype="varchar">
  <field name="sl" caption="数量" sum="true" datatype="number">
  <field name="jldw" caption="单位" group="true" datatype="varchar">


  <field name="jhrq" caption="交货日期" group="true" datatype="date">
  <field name="skdsl" caption="已开单量"  sum="true" datatype="number">
  <field name="wtl" caption="未开单量"  sum="true" datatype="number">
  <field name="stsl" caption="出库出量"  sum="true" datatype="number">
  
  <field name="bz" caption="备注" group="true" datatype="varchar">
  <field name="zts" caption="状态" group="true" datatype="varchar">
  <field name="khlx" caption="客户类型" group="true" datatype="varchar">

  <where field="htrq" caption="合同日期" linktable="" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="{yyyy}-{mm}-01" datatype="date">
  <where field="htrq" caption="--" linktable="" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="{date}" datatype="date">
   <where field="htbh" caption="合同号" linktable="" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="" datatype="varchar">
  <where field="htbh" caption="--" linktable="" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="" datatype="varchar">

 <where field="cpid" caption="品名规格" datatype="number" opersign="=" type="lookup" span="true" codeonchange="productCodeSelect(this,'@')" nameonchange="productNameSelect(this,'@')" onclick="ProdSingleSelect('fixedQueryform','@','fieldVar=cpid&fieldVar=cpbm&fieldVar=product')">	

  <where field="dwtxid" caption="客户名称" datatype="number" opersign="=" type="lookup" span="true"
  codeonchange="corpCodeSelect(this,'@')" nameonchange="corpNameSelect(this,'@')"onclick="CustSingleSelect('fixedQueryform','@','fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc')">
 
  <where field="xm" caption="业务员模糊" datatype="varchar" opersign="like">
  <where field="personid" caption="业务员" need="false" datatype="number" opersign="=" type="select"  lookup="emp" >
  <where field="isnet" caption="合同类型"  opersign="=" value="=全部&0=销售合同&1=来料外加工单合同" type="radio" span="true">

  <param name="fgsid" datatype="number" value="{fgsid}">

    <where field="htlb" caption="类别"  opersign="in" value="0=未审&1=已审&4=作废&8=完成&9=审批中" type="multi" span="true"> 
</dataset>

<table width="100%" border="0" cellspacing="0" cellpadding="1" type="static">
  <tr>
     
    <td align="center"   style="font-size:16" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12" font-bold="1">销售合同执行情况</td>
  </tr>
  <tr>
    <td align="center"  style="font-size:12" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12">{where.a$htrq$a} -- {where.a$htrq$b}</td>
  </tr>
</table>
<table id="tableview1" dataset="a" width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" class="table" fillnull="false" header="1">
  <tr > 
    <td align="center"  nowrap="true" field="htlx">合同类型</td>
    <td align="center"  nowrap="true" field="areacode">地区号</td>
	<td align="center"  nowrap="true" field="dqmc">地区名称</td>
	<td align="center"  nowrap="true" field="dwdm">客户代码</td>
    <td align="center"  nowrap="true" field="dwmc">客户名称</td>
	<td align="center"  nowrap="true" field="mc">部门</td>
	<td align="center"  nowrap="true" field="xm">业务员</td>
	<td align="center"  nowrap="true" field="htrq">日期</td>
    <td align="center"  nowrap="true" field="htbh">合同号</td>
	<td align="center"  nowrap="true" field="cpbm">产品编码</td>
    <td align="center"  nowrap="true" field="pm">品名</td>
    <td align="center"  nowrap="true" field="gg">规格</td>
	<td align="center"  nowrap="true" field="sxz">规格属性</td>
	<td align="center"  nowrap="true" field="sl">数量</td>
	<td align="center"  nowrap="true" field="jldw">单位</td>

	<td align="center"  nowrap="true" field="jhrq">交货日期</td>
	<td align="center"  nowrap="true" field="skdsl">已开单量</td>
    <td align="center"  nowrap="true" field="wtl">未开单量</td>
	<td align="center"  nowrap="true" field="stsl">出库量</td>

	<td align="center"  nowrap="true" field="bz">备注</td>
	<td align="center"  nowrap="true" field="zts">状态</td>
        <td align="center"  nowrap="true" field="khlx">客户类型</td>
  </tr>
  <tr  onClick="selectRow();"  onDblClick="selectRow();detailRep('{htid}')"> 
    <td nowrap="true"><value field="htlx"></td>
    <td nowrap="true" ><value field="areacode" ></td>
	<td nowrap="true" ><value field="dqmc" ></td>
	<td nowrap="true"><value field="dwdm"></td>
    <td nowrap="true"><value field="dwmc"></td>
	<td nowrap="true" ><value field="mc" ></td>
	<td nowrap="true" ><value field="xm" ></td>
	<td nowrap="true"><value field="htrq"></td>
    <td nowrap="true"><value field="htbh"></td>
	<td nowrap="true"><value field="cpbm"></td>
    <td nowrap="true"><value field="pm"></td>
    <td nowrap="true"><value field="gg"></td>
	<td nowrap="true" ><value field="sxz" ></td>
	<td nowrap="true" align="right"><value field="sl" format="#,##0.00" zeroformat=""></td>
	<td nowrap="true" align="right"><value field="jldw" format="#,##0.00" zeroformat=""></td>

	<td nowrap="true" align="right"><value field="jhrq"></td>
	<td nowrap="true" align="right"><value field="skdsl" format="#0.00"></td>
    <td nowrap="true" align="right"><value field="wtl" format="#0.00"></td>
	 <td nowrap="true" align="right"><value field="stsl" format="#0.00"></td>

	 <td nowrap="true" ><value field="bz" ></td>
	 <td nowrap="true" ><value field="zts" ></td>
         <td nowrap="true" ><value field="khlx" ></td>
  </tr>
  <widths value="7,7,7,7,18,7,7,9,11,7,6,7,4,10,11,11,9,11,9,9,9,2"> 
</table>
<SCRIPT LANGUAGE="javascript">initDefaultTableRow('tableview1',1);

 function corpCodeSelect(obj,srcVar)
{
  CustCodeChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc', obj.value);
}
function corpNameSelect(obj,srcVar)
{
  CustNameChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dwtxid&fieldVar=dwdm&fieldVar=dwmc', obj.value);
}
 function productCodeSelect(obj,srcVars)
 {
    SaleProdCodeChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
 }
  function productNameSelect(obj,srcVars)
  {
    SaleProdNameChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
  }

function detailRep(param){
if(param=='')
return;
if(param==null)
return;
  openSelectUrl('../sale_dafa/sale_order_edit.jsp?operate=645355666&code=xs_ht_perform&id='+param, 'sale_order_list');
}
</SCRIPT>
</body>
</html>