<html>
<title name="存货收发汇总表">
<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="25">
<iframe id="prod" src="" width="95%" height=25 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no style="display:none"></iframe>
<page type="templet" height="21" width="29.7" magin-left="1" magin-right="1" magin-top="0.8" magin-bottom="1" footer-center="第 &P 页，共 &N 页" font-size="9">
<dataset name="a" object="PCK_STORE_REP.STOCK_COLLECT(?,'@','@','@','@','@','@','@','@')" type="procedure">

  <field name="cpbm" caption="存货代码" group="true" datatype="varchar">
  <field name="product" caption="品名" group="true" datatype="varchar">
  <field name="gg" caption="规格" group="true" datatype="varchar">
  <field name="qcjc" caption="期初数量" sum="true" datatype="number">
  <field name="qcjchssl" caption="期初换算数量" sum="true" datatype="number">
  <field name="srsl" caption="收入数量" sum="true" datatype="number">
  <field name="jldw" caption="单位" group="true" datatype="varchar">
  <field name="srhssl" caption="收入换算数量" sum="true" datatype="number">
  <field name="hsdw" caption="换算单位" group="true" datatype="varchar">
  <field name="fcsl" caption="发出数量" sum="true" datatype="number">
  <field name="fchssl" caption="发出换算数量" sum="true" datatype="number">
  <field name="qmsl" caption="期末数量" sum="true" datatype="number">
  <field name="qmhssl" caption="期末换算数量" sum="true" datatype="number">

  <where field="rq" caption="日期" linktable="" need="true" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="{yyyy}-{mm}-01" datatype="date">
  <where field="rq" caption="--" linktable=""need="true" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="{date}" datatype="date">
  <where field="storeid" caption="仓库" datatype="number" opersign="=" type="select"  lookup="kc_ck" >
  <where field="chlbid" caption="存货类别" datatype="number" opersign="=" type="select"  lookup="kc_chlb" >
  <where field="cpid" caption="品名规格" datatype="number" opersign="=" type="lookup" span="true" codeonchange="productCodeSelect(this,'@')" nameonchange="productNameSelect(this,'@')" onclick="ProdSingleSelect('fixedQueryform','@','fieldVar=cpid&fieldVar=product')">
 <where field="zt" caption="包括未记帐"  opersign="=" value="1=包括&0=不包括" initvalue="1" type="radio" span="true" >
 <where field="pm" caption="品名模糊" datatype="varchar">
  <param name="fgsid" datatype="number" value="{fgsid}">
</dataset>
<table width="100%" border="0" cellspacing="0" cellpadding="1" type="static">
  <tr>
    <td align="center" valign="middle" style="font_size:16" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12" font-bold="1">存货收发汇总表</td>
  </tr>
  <tr>
	 <td align="center" valign="middle" border-left="0" border-right="0" border-top="0" border-bottom="0">{where.a$rq$a} -- {where.a$rq$b}</td>
  </tr>
</table>
<table dataset="a" id="tableview1" class="table"  width="100%" border="0" cellspacing="0" cellpadding="2" type="dynamic" fillnull="false" header="1">
  <tr>
    <td align="center" valign="middle" nowrap="true" field="cpbm" >存货代码</td>
	<td align="center" valign="middle" nowrap="true" field="product" >品名</td>
	<td align="center" valign="middle" nowrap="true" field="gg" >规格</td>
        <td align="center" valign="middle" nowrap="true" field="qcjc" >期初结存</td>
	<td align="center" valign="middle" nowrap="true" field="qcjchssl" >期初结存换算数量</td>
	<td align="center" valign="middle" nowrap="true" field="srsl">本期收入</td>
	<td align="center" valign="middle" nowrap="true" field="jldw" >计量单位</td>
	<td align="center" valign="middle" nowrap="true" field="srhssl">本期收入换算数量</td>
	<td align="center" valign="middle" nowrap="true" field="hsdw" >换算单位</td>
	<td align="center" valign="middle" nowrap="true" field="fcsl">本期发出</td>
	<td align="center" valign="middle" nowrap="true" field="fchssl">本期发出换算数量</td>
        <td align="center" valign="middle" nowrap="true" field="qmsl">期末结存</td>
	<td align="center" valign="middle" nowrap="true" field="qmhssl">期末结存换算数量</td>
  </tr>

  <tr onClick="selectRow();" onDblClick="selectRow(); detailRep('{cpid}','{fgsid}','{dmsxid}','{where.a$rq$a}','{where.a$rq$b}','{where.a$storeid}','{where.a$zt}','{sxz}')">
	<td nowrap="true"><value field="cpbm"></td>
	<td nowrap="true"><value field="product"></td>
	<td nowrap="true"><value field="gg"></td>
        <td nowrap="true"><value field="jldw"></td>
		 <td nowrap="true"><value field="hsdw"></td>
	<td nowrap="true" align="right"><value field="qcjc" format="{qtyformat}"></td>
	<td nowrap="true" align="right"><value field="qcjchssl" format="{qtyformat}"></td>
        <td nowrap="true" align="right"><value field="srsl" format="{qtyformat}"></td>
		<td nowrap="true" align="right"><value field="srhssl" format="{qtyformat}"></td>
        <td nowrap="true" align="right"><value field="fcsl" format="{qtyformat}"></td>
		 <td nowrap="true" align="right"><value field="fchssl" format="{qtyformat}"></td>
	<td nowrap="true" align="right"><value field="qmsl" format="{qtyformat}"></td>
	<td nowrap="true" align="right"><value field="qmhssl" format="{qtyformat}"></td>
  </tr>
  <widths value="10,18,7,7,7,7,7,7,7">
</table>
<SCRIPT LANGUAGE="javascript">initDefaultTableRow('tableview1',1);
function propertyNameSelect(obj,cpid, srcVar)
{
  PropertyNameChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dmsxid&fieldVar=sxz', cpid, obj.value);
}
function productCodeSelect(obj,srcVars)
 {
    ProdCodeChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
 }
  function productNameSelect(obj,srcVars)
  {
    ProdNameChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
  }
function detailRep(param,fgsid,dmsxid,ksrq,jsrq,storeid,zt,sxz){
 if(param=="")
	return;
 openSelectUrl('showdetail.jsp?operate=showdetail&code=kc_stocks_detail_shengyu&a$cpid='+param+'&a$rq$a='+ksrq+'&a$rq$b='+jsrq+'&a$storeid='+storeid+'&a$fgsid='+fgsid+'&a$dmsxid='+dmsxid+'&a$zt='+zt+'&a$sxz='+sxz, 'kc_stocks_detail');
}
</SCRIPT>
</body>
</html>