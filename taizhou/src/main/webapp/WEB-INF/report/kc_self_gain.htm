<html>
<title name="自制收货单明细表">
<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="25">
<iframe id="prod" src="" width="95%" height=25 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no style="display:none"></iframe>
<page type="templet" height="29.7" width="21" magin-left="1" magin-right="1" magin-top="0.8" magin-bottom="1" footer-center="第 &P 页，共 &N 页" font-size="9">
 <dataset name="a" object="rep_self_gain" type="sql">
  <field name="receivecode"   caption="收货单号"    group="true" datatype="varchar">
  <field name="receivedate"   caption="收货日期"    group="true" datatype="varchar">
  <field name="ckmc"       caption="仓库"        group="true" datatype="varchar">
  <field name="mc"         caption="完工车间"        group="true" datatype="varchar">
  <field name="handleperson"  caption="经手人"   group="true" datatype="varchar">
  <field name="xm"         caption="审批人"      group="true" datatype="varchar">
  <field name="creator"    caption="制单人"      group="true" datatype="varchar">
  <field name="state"      caption="状态"        group="true" datatype="varchar">

  <field name="cpbm"     caption="产品编码"  group="true" datatype="varchar">
  <field name="product"  caption="品名"      group="true" datatype="varchar">
  <field name="sxz"      caption="规格属性"  group="true" datatype="varchar">
  <field name="drawnum"  caption="数量"      group="true" datatype="varchar">
  <field name="jldw"     caption="计量单位"  group="true" datatype="varchar">
  <field name="drawbignum"  caption="换算数量"  group="true" datatype="varchar">
  <field name="hsdw"     caption="换算单位"  group="true" datatype="varchar">
  <field name="hjsl" caption="合计" sum="true" datatype="number">
  <field name="hjhssl" caption="合计换算" sum="true" datatype="number">

  <where field="receivedate" caption="日期" linktable="" need="true" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="{yyyy}-{mm}-01" datatype="date">
  <where field="receivedate" caption="--" linktable="" need="true" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="{date}" datatype="date">
  <where field="cpid" caption="品名规格" datatype="number" opersign="=" type="lookup" span="true" codeonchange="productCodeSelect(this,'@')" nameonchange="productNameSelect(this,'@')" onclick="ProdSingleSelect('fixedQueryform','@','fieldVar=cpid&fieldVar=cpbm&fieldVar=product')">
  <where field="dmsxid" caption="规格属性" datatype="number" opersign="=" type="lookup" span="true"
  nameonchange="if(fixedQueryform.A$CPID.value==''){alert('请选择产品');return;}propertyNameSelect(this,fixedQueryform.A$CPID.value,'@')"
 onclick="if(fixedQueryform.A$CPID.value==''){alert('请选择产品');return;}PropertySelect('fixedQueryform','@','fieldVar=dmsxid&fieldVar=sxz',fixedQueryform.A$CPID.value)">
  <where field="storeid" caption="仓库" datatype="number" opersign="=" type="select"  lookup="kc_ck" >
  <where field="chlbid" caption="存货类别" datatype="number" opersign="=" type="select"  lookup="kc_chlb" >
  <where field="cpbm" caption="产品编码" linktable="" linkcolumn="" querycolumn="" extendname="a" opersign="&gt;=" initvalue="" datatype="varchar">
  <where field="cpbm" caption="--" linktable="" linkcolumn="" querycolumn="" extendname="b" opersign="&lt;=" initvalue="" datatype="varchar">
  <%--where field="pm" caption="品名" datatype="varchar">
  <where field="gg" caption="规格" datatype="varchar">
  <where field="ph" caption="批号" datatype="varchar"--%>
  <%--param name="fgsid" datatype="number" value="{fgsid}">
  <param name="personid" datatype="number" value="{personid}"--%>
</dataset>
<table width="100%" border="0" cellspacing="0" cellpadding="1" type="static">
  <tr>
     <td align="center" valign="middle" style="font-size:16" border-left="0" border-right="0" border-top="0" border-bottom="0" font-size="12" font-bold="1">自制收货单明细表</td>
  </tr>
   <tr>
         <td align="center" valign="middle" border-left="0" border-right="0" border-top="0" border-bottom="0">{where.a$receivedate$a} -- {where.a$receivedate$b}</td>
  </tr>
</table>
<table id="tableview1" dataset="a" width="100%" border="0" cellspacing="0" cellpadding="2" class="table" type="dynamic" fillnull="false" header="1">
  <tr>
   <td align="center" valign="middle" nowrap="true" field="receivecode">收货单号</td>
   <td align="center" valign="middle" nowrap="true" field="receivedate">收货日期</td>
   <td align="center" valign="middle" nowrap="true" field="ckmc">仓库</td>
   <td align="center" valign="middle" nowrap="true" field="mc">完工车间</td>
   <td align="center" valign="middle" nowrap="true" field="handleperson">经手人</td>
   <td align="center" valign="middle" nowrap="true" field="xm">审批人</td>
   <td align="center" valign="middle" nowrap="true" field="creator">制单人</td>
   <td align="center" valign="middle" nowrap="true" field="state">状态</td>

    <td align="center" valign="middle" nowrap="true" field="cpbm">产品编码</td>
    <td align="center" valign="middle" nowrap="true" field="product">品名</td>
    <td align="center" valign="middle" nowrap="true" field="sxz">规格属性</td>
    <td align="center" valign="middle" nowrap="true" field="drawnum">数量</td>
    <td align="center" valign="middle" nowrap="true" field="jldw">计量单位</td>
    <td align="center" valign="middle" nowrap="true" field="drawbignum">换算数量</td>
    <td align="center" valign="middle" nowrap="true" field="hsdw">换算单位</td>
    <td align="center" valign="middle" nowrap="true" field="hjsl">合计</td>
    <td align="center" valign="middle" nowrap="true" field="hjhssl">合计换算</td>
  </tr>
  <tr onClick="selectRow();">
   <td nowrap="true"><value field="receivecode"></td>
    <td nowrap="true"><value field="receivedate"></td>
    <td nowrap="true"><value field="ckmc"></td>
    <td nowrap="true"><value field="mc"></td>
    <td nowrap="true"><value field="handleperson"></td>
    <td nowrap="true"><value field="xm"></td>
    <td nowrap="true"><value field="creator"></td>
    <td nowrap="true"><value field="state"></td>

    <td nowrap="true"><value field="cpbm"></td>
    <td nowrap="true"><value field="product"></td>
    <td nowrap="true"><value field="sxz"></td>
    <td nowrap="true"><value field="drawnum"></td>
    <td nowrap="true"><value field="jldw"></td>
    <td nowrap="true"><value field="drawbignum"></td>
    <td nowrap="true"><value field="hsdw"></td>
    <td nowrap="true"><value field="hjsl"></td>
    <td nowrap="true"><value field="hjhssl"></td>
  </tr>
  <widths value="11,18,11,7,7,10,10,7,7,7,7,7,7,7,7">
</table>
<SCRIPT LANGUAGE="javascript">initDefaultTableRow('tableview1',1);
function propertyNameSelect(obj,cpid, srcVar)
{
  PropertyNameChange(document.all['prod'], obj.form.name, srcVar,
                 'fieldVar=dmsxid&fieldVar=sxz', cpid, obj.value);
}
function productCodeSelect(obj,srcVars)
 {
    ProdCodeChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
 }
  function productNameSelect(obj,srcVars)
  {
    ProdNameChange(document.all['prod'], obj.form.name, srcVars,
                   'fieldVar=cpid&fieldVar=cpbm&fieldVar=product', obj.value);
  }
</SCRIPT>
</body>
</html>